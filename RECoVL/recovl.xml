<tool id="recovl" name="RECoVL" version="3.1">
    <description>Only to be used through IRIDA</description>
    <requirements>
        <requirement type="package" version="3.7">python</requirement>
        <requirement type="package" version="2">pangolin</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" level="fatal" description="Tool exception" />
        <exit_code range=":-1" level="fatal" description="Tool exception" />
    </stdio>
    <command>
<![CDATA[
    #import subprocess
    #if $token == "D85SteptkQZ9MobOk9pa":
        #set $library = $subprocess.getoutput('cat ' + str($librarytype))
        #if $library == "sang":
            python 
		    $__tool_directory__/RECoVL.py --variants $variants --strain $strain --lineage $lineage
		#else:
            pangolin --min-length 10000 $consensus --outfile $lineage
        #end if  
    #else:
        touch $lineage
    #end if  
]]>
    </command>
    <inputs>
        <param name="token" type="text" label="execution token" />
        <param name="strain" type="text" label="name" />
        <param name="librarytype" format="txt" type="data" label="library type" />
        <param name="consensus" format="fasta" type="data" label="consensus fasta file" />
        <param name="variants" format="tabular" type="data" label="variants tabular file" />
    </inputs>

    <outputs>
		<data format="csv" name="lineage" label="${tool.name} on ${on_string}" />
   </outputs>
</tool>
